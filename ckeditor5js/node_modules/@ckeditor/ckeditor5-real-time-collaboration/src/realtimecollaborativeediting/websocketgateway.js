/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x419d=['code','get','removeFromReconnectionStack','init','destroy','limitExceeded','plugins','add','CloudServices','cloudServices.requestTimeout','connected','create','addToReconnectionStack','connection','initialReconnectionInterval','catch','then','The\x20limit\x20of\x20maximum\x20concurrent\x20connections\x20that\x20the\x20collaboration\x20server\x20can\x20handle\x20has\x20been\x20reached.\x20Try\x20opening\x20the\x20document\x20again\x20in\x20a\x20few\x20minutes.\x20Please\x20contact\x20your\x20system\x20administrator\x20if\x20the\x20problem\x20persists.','stopListening','all','online','isInReconnectionStack','function','disconnected','websocketgateway-missing-token','reconnect','offline','from','state','pluginName','Connected\x20users\x20limit\x20exceeded','define','token','cloudServices.connectionTimeout','websocketgateway-invalid-plugin-interface','webSocketUrl','_domEmitter','connecting','_reconnect','_isBrowserOffline','_shouldPluginsReconnect','cloudservices-init','set','constructor','delete','websocketgateway-plugin-already-registered','_reconnectionStack','connect','error','WebSocketGateway','change:me','listenTo','config','requires','disconnect','context','websocketgateway-missing-websocket-url','has'];(function(_0x2d13b3,_0x419da8){const _0xb19392=function(_0x4f219e){while(--_0x4f219e){_0x2d13b3['push'](_0x2d13b3['shift']());}};_0xb19392(++_0x419da8);}(_0x419d,0x121));const _0xb193=function(_0x2d13b3,_0x419da8){_0x2d13b3=_0x2d13b3-0x0;let _0xb19392=_0x419d[_0x2d13b3];return _0xb19392;};import{ContextPlugin as _0x2f6e20}from'ckeditor5/src/core';import{DomEmitterMixin as _0x4bef83,CKEditorError as _0x47bad2}from'ckeditor5/src/utils';import _0x83167d from'@ckeditor/ckeditor-cloud-services-collaboration/src/websocketgateway/websocketgateway';import{Notification as _0x3347d9}from'ckeditor5/src/ui';export default class c extends _0x2f6e20{static get[_0xb193('0x36')](){return[_0xb193('0x9'),_0x3347d9];}static get[_0xb193('0x1e')](){return'WebSocketGateway';}[_0xb193('0x4')](){const _0x298d6e=this[_0xb193('0x38')],_0x4e0a02=_0x298d6e[_0xb193('0x7')]['get']('CloudServices'),_0x2ac8da=_0x298d6e['plugins'][_0xb193('0x2')](_0x3347d9);if(!_0x4e0a02[_0xb193('0x21')])throw new _0x47bad2(_0xb193('0x19'),this);if(!_0x4e0a02[_0xb193('0x24')])throw new _0x47bad2(_0xb193('0x39'),this);return this[_0xb193('0x2b')]('state',_0xb193('0x26')),this[_0xb193('0x2b')](_0xb193('0x28'),!0x1),this['_reconnectionStack']=new Set(),this['_shouldPluginsReconnect']=!0x1,this['_domEmitter']=Object[_0xb193('0xc')](_0x4bef83),this[_0xb193('0x25')]['listenTo'](window,_0xb193('0x1b'),()=>this[_0xb193('0x28')]=!0x0),this[_0xb193('0x25')][_0xb193('0x34')](window,_0xb193('0x15'),()=>this[_0xb193('0x28')]=!0x1),this[_0xb193('0x38')][_0xb193('0x35')][_0xb193('0x20')](_0xb193('0x22'),0xa),this[_0xb193('0x38')][_0xb193('0x35')]['define'](_0xb193('0xa'),0x14),c['WebSocketGateway'][_0xb193('0x30')](_0x4e0a02[_0xb193('0x21')],_0x4e0a02[_0xb193('0x24')],{'disconnectOnUnload':!0x1,'timeout':0x3e8*this[_0xb193('0x38')]['config'][_0xb193('0x2')]('cloudServices.connectionTimeout'),'requestTimeout':0x3e8*this['context'][_0xb193('0x35')][_0xb193('0x2')]('cloudServices.requestTimeout')})['then'](_0x2480eb=>{if(this[_0xb193('0xe')]=_0x2480eb,this['bind']('state')['to'](_0x2480eb,'state',this,_0xb193('0x28'),(_0x33f2e5,_0x1d4426)=>('connected'!==_0x33f2e5&&(this[_0xb193('0x29')]=!0x0),_0x1d4426||_0xb193('0xb')!==_0x33f2e5?_0xb193('0x18'):_0xb193('0x18')==this['state']&&this[_0xb193('0x29')]?(this[_0xb193('0x29')]=!0x1,this[_0xb193('0x27')](),_0xb193('0x26')):_0xb193('0xb'))),this['connection']['on'](_0xb193('0x31'),(_0x3f525a,_0x1764d6)=>{if(_0xb193('0x6')!==_0x1764d6[_0xb193('0x1')])throw console['error'](_0x1764d6),new _0x47bad2(_0xb193('0x2a'),null,{'originalError':_0x1764d6});_0x2ac8da['showWarning'](_0xb193('0x12'),{'title':_0xb193('0x1f'),'namespace':'real-time-collaboration'});}),!_0x2480eb['me'])return new Promise(_0x21702f=>_0x2480eb['on'](_0xb193('0x33'),_0x21702f));})['catch'](_0xb29937=>{throw console[_0xb193('0x31')](_0xb29937),new _0x47bad2(_0xb193('0x2a'),null,{'originalError':_0xb29937});});}[_0xb193('0xd')](_0x105ad8){if(_0xb193('0x17')!=typeof _0x105ad8[_0xb193('0x1a')])throw new _0x47bad2(_0xb193('0x23'),this);if(this[_0xb193('0x16')](_0x105ad8))throw new _0x47bad2(_0xb193('0x2e'),this,{'name':_0x105ad8[_0xb193('0x2c')][_0xb193('0x1e')]});this[_0xb193('0x2f')][_0xb193('0x8')](_0x105ad8);}[_0xb193('0x3')](_0x1ccc4a){this[_0xb193('0x2f')][_0xb193('0x2d')](_0x1ccc4a);}[_0xb193('0x16')](_0x288ed2){return this['_reconnectionStack'][_0xb193('0x0')](_0x288ed2);}[_0xb193('0x27')](){return this[_0xb193('0xe')]['reconnect']()['then'](()=>Promise[_0xb193('0x14')](Array[_0xb193('0x1c')](this['_reconnectionStack'],_0x4552fb=>_0x4552fb['reconnect']())))[_0xb193('0x11')](()=>this[_0xb193('0x1d')]=_0xb193('0xb'))[_0xb193('0x10')](_0x4e94e1=>{throw console[_0xb193('0x31')](_0x4e94e1),new _0x47bad2('cloudservices-reconnection-error',this[_0xb193('0x38')]);});}[_0xb193('0x5')](){this['connection']&&this[_0xb193('0xe')][_0xb193('0x37')](),this['state']=_0xb193('0x18'),this[_0xb193('0x25')][_0xb193('0x13')](),super[_0xb193('0x5')]();}}c[_0xb193('0x32')]=_0x83167d,c[_0xb193('0xf')]=0x3e8;