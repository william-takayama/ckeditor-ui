/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3eba=['enableReadOnlyMode','cloud-services-internal-error:\x20Collaborative\x20Editing\x20Service\x20is\x20not\x20connected.','The\x20local\x20document\x20and\x20server\x20document\x20differ\x20and\x20merging\x20them\x20can\x20cause\x20unexpected\x20behavior.\x20To\x20not\x20lose\x20your\x20content\x20save\x20it\x20locally\x20and\x20refresh\x20the\x20editor.','enqueueChange','getUser','_handleInitialConnectionData','history','_isInit','editing','pluginName','_ignoredOperations','disconnected','init','The\x20last\x20saved\x20version\x20of\x20the\x20document\x20does\x20not\x20match\x20the\x20local\x20version.\x20To\x20not\x20lose\x20your\x20content\x20save\x20it\x20locally\x20and\x20refresh\x20the\x20editor.','_isDisconnection','removeFromReconnectionStack','_channelId','sessionAdd:','requires','data','_initThrowingOnDataSet','mySessionId','_sendBufferedOperationsDelayId','connect','_lastServerVersion','createPositionFromPath','_sendBufferedOperationsDelayed','reconnection:\x20flushed\x20session','userId','_lastSyncedOperationId','createPositionAt','showWarning','destroy','_hasSynchronizationProblem','getRoot','baseVersion','rtc-destroyed','rtc-offline','lastDocumentSession','CommentsOnly','offset','set','locale','has','_disconnectService','reset','config','_compressOperations','_currentBufferDelay','_sendBufferedOperations','affectsData','map','createdAt','view','fromJSON','_hasSelectionChanged','_compressor','_assignOperationsMetaData','suppressErrorInCollaboration','cs:removeUser','_updateServerHistory','_shouldSendSelectionUpdate','sessionId','code','collaboration','_isEditingAllowed','realtimecollaborationclient-editor-setdata-and-editor-data-set-are-forbidden-in-real-time-collaboration','The\x20document\x20cannot\x20be\x20connected\x20back\x20to\x20the\x20server.\x20To\x20not\x20lose\x20your\x20content\x20save\x20it\x20locally\x20and\x20refresh\x20the\x20editor.','_getOperationsFromInitData','_setUpDataInit','_authorId','connected','lastOperationId','isDocumentOperation','sessionCreatedAt','PENDING_ACTION_SENDING_DATA','_operationIdentifier','_fetchMissingUsers','_initSessionsHandling','addToReconnectionStack','reconnect','_connectService','getOperationAuthor','editor','message','setIdForTheLastOperation','_operationToId','The\x20document\x20details\x20could\x20not\x20be\x20taken\x20during\x20the\x20reconnection.\x20To\x20not\x20lose\x20your\x20content\x20save\x20it\x20locally\x20and\x20refresh\x20the\x20editor.','_crash','channelSessions','from','_handleReconnectionResponse','marker','getIdOfTheLastOperation','setPermissions','length','disableReadOnlyMode','wasUndone','cloudServices.bundleVersion','_isPendingUpdate','unregister','getOperations','document:write','get','path','_baseBufferDelay','define','applyOperation','compress','add','high','_shouldSendUpdate','404','isEnabled','string','bind','stop','toJSON','_handleExternalOperations','_pendingAction','_applyOperationsSet','change:hasDomSelection','batch','realtimecollaborationclient-initservice-incorrect-server-operation','currentDocumentSession','push','_bufferedOperations','start','serverHistory','clone','wereChangesApplied','realtimecollaborationclient-init-non-existent-root','catch','metadata','error','_refreshUserSelectionMarkers','selection','plugins','version','createUserMarkerOperations','lastSyncVersion','ready','_clearPendingAction','remove','operationsReceived','lastOperationAcceptedAt','_isConnected','_handleSendingSelectionMarkers','document','initData','sendOperations','getDocumentDetails','realtimecollaborationclient-init-connection-failed','cloud-services-internal-error:\x20Request\x20timeout.','disconnect','_connectAfterSessionHasBeenFlushed','connection','round','_setPendingAction','_decompressOperations','markers','apply','realtimecollaborationclient-handleserverresponse','_knownOperations','_document','off','roots','_offset','_sendBufferedOperationsDelay','addOperation','decompress','forEach','then','_disconnectionOperations','startsWith','parse','cloud-services-internal-error:\x20Not\x20connected.','slice','isReadOnly','_service','includes','realtimecollaborationclient-sendbufferedoperations','_handleServerResponse','model','listenTo','type','_handleReconnectionError','getConnectedSessions','collaboration-missing-channelid','return','_handleReceivedOperations','CollaborativeEditingService','keys','filter','addUser','realtimecollaborationclient-initservice-internal-error'];(function(_0x163d6a,_0x3ebae1){const _0x2d3008=function(_0x13333c){while(--_0x13333c){_0x163d6a['push'](_0x163d6a['shift']());}};_0x2d3008(++_0x3ebae1);}(_0x3eba,0xc1));const _0x2d30=function(_0x163d6a,_0x3ebae1){_0x163d6a=_0x163d6a-0x0;let _0x2d3008=_0x3eba[_0x163d6a];return _0x2d3008;};import{Plugin as _0x3aa819,PendingActions as _0x164be4}from'ckeditor5/src/core';import{CKEditorError as _0x536333,version as _0x265fdc,uid as _0x397a33}from'ckeditor5/src/utils';import{transformSets as _0x1e7ecc,InsertOperation as _0x173898,MarkerOperation as _0x576ac8,OperationFactory as _0x9cf77c,History as _0x5268ab}from'ckeditor5/src/engine';import{Notification as _0x50375d}from'ckeditor5/src/ui';import{Users as _0x42fea8}from'ckeditor5-collaboration/src/collaboration-core';import _0x3f8da5 from'./websocketgateway';import _0x4e5a25 from'./sessions';import _0x30afe9 from'./usermarkers';import{getTranslation as _0x1fd8b8}from'../common-translations';import _0x3e1848 from'@ckeditor/ckeditor5-operations-compressor/src/compressor';import _0x575cd8 from'@ckeditor/ckeditor-cloud-services-collaboration/src/collaborativeeditingservice/collaborativeeditingservice';import _0x1d24e4 from'@ckeditor/ckeditor-cloud-services-collaboration/src/users/user';let Q=0x1;export default class l extends _0x3aa819{static get[_0x2d30('0x15')](){return[_0x3f8da5,_0x4e5a25,_0x30afe9,_0x164be4,_0x42fea8,_0x50375d];}static get[_0x2d30('0xc')](){return'RealTimeCollaborationClient';}get['cloudDocumentVersion'](){return this[_0x2d30('0x1b')]+this[_0x2d30('0xaa')];}get[_0x2d30('0x1b')](){return this[_0x2d30('0x83')][_0x2d30('0x8d')]-this['_offset'];}get[_0x2d30('0x8f')](){const _0x896997=this['serverHistory'][_0x2d30('0x68')]();for(let _0x4dd320=_0x896997['length']-0x1;_0x4dd320>=0x0;_0x4dd320--){const _0x5e9a8f=_0x896997[_0x4dd320];if(!this[_0x2d30('0xb0')][_0x2d30('0x2e')](_0x5e9a8f))return _0x5e9a8f[_0x2d30('0x26')]+0x1-this[_0x2d30('0xaa')];}return 0x0;}[_0x2d30('0xf')](){const _0x33dc4d=this[_0x2d30('0x56')],_0x1a33d1=_0x33dc4d['plugins'][_0x2d30('0x6a')](_0x42fea8),_0x274c8b=_0x33dc4d['plugins'][_0x2d30('0x6a')](_0x3f8da5);if(this[_0x2d30('0xaa')]=0x0,this[_0x2d30('0x41')]=null,this[_0x2d30('0x83')]=new _0x5268ab(),this['editor']['config'][_0x2d30('0x6d')](_0x2d30('0x43'),{}),this[_0x2d30('0x13')]=_0x33dc4d[_0x2d30('0x31')][_0x2d30('0x6a')]('collaboration.channelId'),!this['_channelId'])throw new _0x536333(_0x2d30('0xbf'),this);this['listenTo'](_0x1a33d1,_0x2d30('0x55'),(_0x18e6ba,_0x2dd9aa)=>{const _0x95a68=_0x2dd9aa[0x0];_0x95a68['_authorId']&&(_0x18e6ba[_0x2d30('0xc0')]=_0x1a33d1[_0x2d30('0x7')](_0x95a68[_0x2d30('0x49')]),_0x18e6ba[_0x2d30('0x77')]()),null===_0x95a68[_0x2d30('0x49')]&&(_0x18e6ba['return']=null,_0x18e6ba[_0x2d30('0x77')]());},{'priority':_0x2d30('0x71')});const _0x5dd9dc=_0x33dc4d[_0x2d30('0x31')]['get'](_0x2d30('0x65'))||_0x265fdc;this[_0x2d30('0xb6')]=new l[(_0x2d30('0xc2'))](_0x5dd9dc,this[_0x2d30('0x13')]),this['_document']=this[_0x2d30('0x56')]['model'][_0x2d30('0x97')],this[_0x2d30('0x3b')]=new _0x3e1848(),this[_0x2d30('0x81')]=[],this[_0x2d30('0xa6')]=new WeakSet(),this[_0x2d30('0x2c')]('_isPendingUpdate',!0x1),this['set'](_0x2d30('0x24'),!0x1),this[_0x2d30('0x7a')]=null,this[_0x2d30('0x3a')]=!0x1,this[_0x2d30('0x19')]=null,this[_0x2d30('0x6c')]=0x12c,this[_0x2d30('0x33')]=this[_0x2d30('0x6c')],this[_0x2d30('0x20')]=null,this[_0x2d30('0xb0')]=new WeakSet(),this[_0x2d30('0x4f')]=new Z(this[_0x2d30('0xb0')]),this[_0x2d30('0xbb')](_0x33dc4d[_0x2d30('0xba')][_0x2d30('0x97')][_0x2d30('0x8b')],'change:range',(_0x21f34b,_0x33c7d7)=>{_0x33c7d7['directChange']&&this[_0x2d30('0x8a')]();}),this[_0x2d30('0xbb')](_0x33dc4d[_0x2d30('0xb')][_0x2d30('0x38')],_0x2d30('0x7c'),()=>{this[_0x2d30('0x8a')]();}),this[_0x2d30('0x17')](),_0x33dc4d[_0x2d30('0x8c')][_0x2d30('0x6a')](_0x3f8da5)[_0x2d30('0x52')](this),_0x33dc4d['model']['on'](_0x2d30('0x6e'),(_0x2f6e4e,_0x5c910a)=>{const _0x5b03c7=_0x5c910a[0x0];_0x5b03c7[_0x2d30('0x4c')]&&(this['_saveOperationInBuffer'](_0x5b03c7),this[_0x2d30('0x72')]()&&this[_0x2d30('0x1d')]());}),this[_0x2d30('0x48')](),this[_0x2d30('0x76')](_0x2d30('0x44'))['to'](_0x274c8b,'state',this,'_hasSynchronizationProblem',(_0x5d6a9d,_0xd6023a)=>_0x2d30('0x4a')===_0x5d6a9d&&!_0xd6023a),this['on']('change:_isEditingAllowed',()=>{this[_0x2d30('0x44')]?_0x33dc4d[_0x2d30('0x63')](_0x2d30('0x28')):_0x33dc4d[_0x2d30('0x3')]('rtc-offline');}),this[_0x2d30('0x44')]?_0x33dc4d[_0x2d30('0x63')](_0x2d30('0x28')):_0x33dc4d[_0x2d30('0x3')](_0x2d30('0x28')),this[_0x2d30('0x2c')](_0x2d30('0x95'),!0x1);}async[_0x2d30('0x53')](){const _0x480259=this[_0x2d30('0x56')][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x4e5a25),_0x5a5363=this['editor'][_0x2d30('0x8c')]['get'](_0x3f8da5);try{this['_isPendingUpdate']=!0x0,_0x480259[_0x2d30('0x67')](this['_channelId']);const _0x39450c=await this[_0x2d30('0xb6')][_0x2d30('0x53')](_0x5a5363[_0x2d30('0x9f')],this[_0x2d30('0x8f')]);await this[_0x2d30('0x5e')](_0x39450c)&&(this[_0x2d30('0x66')]=!0x1,this[_0x2d30('0x91')]());const _0x192036=await this[_0x2d30('0xb6')][_0x2d30('0xbe')]();_0x480259['register'](this[_0x2d30('0x13')],_0x192036),this[_0x2d30('0x96')](),this[_0x2d30('0x95')]=!0x0;}catch(_0x4d8bb6){if(function(_0x462f48){return _0x2d30('0x73')===_0x462f48['code'];}(_0x4d8bb6)&&this[_0x2d30('0x41')])await this[_0x2d30('0x9e')]();else{if(function(_0xc160ae){return'409'===_0xc160ae[_0x2d30('0x42')];}(_0x4d8bb6)){const _0x350b81=_0x1fd8b8(this[_0x2d30('0x56')][_0x2d30('0x2d')],_0x2d30('0x46'));this[_0x2d30('0xbd')](_0x350b81);}else{if(!(_0x4d8bb6 instanceof X))throw _0x4d8bb6;this[_0x2d30('0xbd')]();}}}}['destroy'](){const _0x18399b=this[_0x2d30('0x56')][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x3f8da5),_0x5356dc=this['editor'][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x4e5a25);this['editor'][_0x2d30('0x3')](_0x2d30('0x27')),_0x5356dc[_0x2d30('0x5c')][_0x2d30('0x2e')](this[_0x2d30('0x13')])&&_0x5356dc[_0x2d30('0x67')](this['_channelId']),_0x18399b[_0x2d30('0x12')](this),this[_0x2d30('0x2f')](),super[_0x2d30('0x23')]();}async[_0x2d30('0x5e')](_0x371e26){if(this[_0x2d30('0x41')]!==_0x371e26[_0x2d30('0x41')]&&this[_0x2d30('0x20')]!==_0x371e26[_0x2d30('0x4b')])throw new X();return this[_0x2d30('0x41')]=_0x371e26[_0x2d30('0x41')],this[_0x2d30('0xb9')]([],{..._0x371e26,'wereChangesApplied':!0x1,'data':_0x371e26[_0x2d30('0x16')]},_0x2d30('0x53'));}async[_0x2d30('0x54')](_0x28673b,_0x32d796=!0x1){const {connection:_0xfbbc06}=this[_0x2d30('0x56')][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x3f8da5);l[_0x2d30('0xc2')]['getConnectedSessions'](_0xfbbc06,this[_0x2d30('0x13')])[_0x2d30('0xaf')](_0xb76580=>this[_0x2d30('0x51')](_0xb76580))[_0x2d30('0x87')](_0x2acc3c=>{this[_0x2d30('0x5b')]('realtimecollaborationclient-init-session-connection-error',_0x2acc3c);}),this[_0x2d30('0xbb')](this['_service'],_0x2d30('0x93'),this['_handleReceivedOperations']['bind'](this)),this[_0x2d30('0xbb')](this[_0x2d30('0xb6')],_0x2d30('0x89'),(_0x483ea0,_0x4a8f87)=>{this[_0x2d30('0x5b')](_0x2d30('0x2'),_0x4a8f87);}),this[_0x2d30('0xbb')](this[_0x2d30('0xb6')],_0x2d30('0xe'),()=>{this[_0x2d30('0x95')]=!0x1;});const _0x2f919e=this[_0x2d30('0x4f')][_0x2d30('0x60')](_0x28673b),_0x3a8150=await this[_0x2d30('0xb6')][_0x2d30('0x1a')](_0xfbbc06,this[_0x2d30('0x32')](_0x28673b),_0x2f919e);if(this[_0x2d30('0x41')]=_0x3a8150['sessionId'],_0x3a8150[_0x2d30('0x85')]&&(this[_0x2d30('0x66')]=!0x1,this[_0x2d30('0x91')]()),_0x32d796){if(!_0x3a8150[_0x2d30('0x85')])return void this['_handleReconnectionError']();this[_0x2d30('0x83')][_0x2d30('0x30')](),this['_offset']=_0x3a8150[_0x2d30('0x2b')],this[_0x2d30('0x83')]['version']=this[_0x2d30('0xaa')],await this[_0x2d30('0xb9')](_0x28673b,_0x3a8150,_0x2d30('0x1e'));}else await this[_0x2d30('0x8')](_0x3a8150,_0x28673b);this['_handleSendingSelectionMarkers'](),this[_0x2d30('0x95')]=!0x0;}[_0x2d30('0x96')](){const _0x3bed7d=this[_0x2d30('0x56')][_0x2d30('0x8c')]['get'](_0x4e5a25),_0x2c100d=_0x3bed7d['channelSessions'][_0x2d30('0x6a')](this[_0x2d30('0x13')]);_0x2c100d&&_0x2c100d[_0x2d30('0x62')]>0x1?(this['_hasSelectionChanged']=!0x0,this[_0x2d30('0x1d')]()):this[_0x2d30('0xbb')](_0x3bed7d,_0x2d30('0x14')+this[_0x2d30('0x13')],_0x58f716=>{_0x3bed7d[_0x2d30('0x5c')][_0x2d30('0x6a')](this[_0x2d30('0x13')])[_0x2d30('0x62')]>0x1&&(this[_0x2d30('0x3a')]=!0x0,this[_0x2d30('0x1d')](),_0x58f716[_0x2d30('0xa8')]());});}async[_0x2d30('0xc1')](_0x2c4cae,_0x3c50fc,_0x35016a,_0x18fd0a){if(!this[_0x2d30('0x66')]&&this[_0x2d30('0xa7')][_0x2d30('0x8d')]==_0x3c50fc){const _0x54b1d9=this[_0x2d30('0xa2')](_0x35016a,_0x18fd0a);await this[_0x2d30('0x50')](_0x54b1d9),this[_0x2d30('0x79')](_0x54b1d9,_0x3c50fc,_0x35016a[_0x2d30('0x4b')])||this['_crash'](_0x2d30('0x7e'));}}async[_0x2d30('0x9e')](){this['_disconnectService']();const {locale:_0x5c9322}=this['editor'];let _0x350c5f;try{_0x350c5f=await this[_0x2d30('0xb6')][_0x2d30('0x9a')]();}catch(_0x4a5c85){const _0x2cf9ca=_0x1fd8b8(_0x5c9322,_0x2d30('0x5a'));return void this[_0x2d30('0xbd')](_0x2cf9ca);}const _0xf97843=_0x350c5f[_0x2d30('0x7f')]||_0x350c5f[_0x2d30('0x29')];if(this[_0x2d30('0x20')]===_0xf97843['lastOperationId'])await this[_0x2d30('0x54')](this[_0x2d30('0x56')][_0x2d30('0xba')][_0x2d30('0x97')]['history']['getOperations'](),!0x0);else{const _0x3f59e2=_0x1fd8b8(_0x5c9322,_0x2d30('0x10'));this['_handleReconnectionError'](_0x3f59e2);}}[_0x2d30('0x2f')](){this[_0x2d30('0xb6')][_0x2d30('0x9d')](),this[_0x2d30('0x81')]=[],clearTimeout(this[_0x2d30('0xab')]),this['stopListening'](this[_0x2d30('0xb6')]);}['_initSessionsHandling'](_0x5b42c6){const _0x1b9997=this['editor']['plugins'][_0x2d30('0x6a')](_0x4e5a25);this[_0x2d30('0xbb')](_0x1b9997,_0x2d30('0x14')+this[_0x2d30('0x13')],(_0x2e268b,{session:_0x98f361})=>{if(_0x98f361['id']===_0x1b9997[_0x2d30('0x18')]){_0x2e268b[_0x2d30('0xa8')]();const _0x11f206=this[_0x2d30('0x56')][_0x2d30('0x8c')][_0x2d30('0x2e')](_0x2d30('0x2a'))&&this['editor'][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x2d30('0x2a'));let _0x3a45fd=_0x98f361['permissions'];_0x11f206&&_0x11f206[_0x2d30('0x74')]&&(_0x3a45fd=_0x3a45fd[_0x2d30('0x0')](_0x3c6b90=>_0x2d30('0x69')!==_0x3c6b90)),this['editor'][_0x2d30('0x8c')]['get']('Permissions')[_0x2d30('0x61')](_0x3a45fd,this[_0x2d30('0x13')]);}}),_0x1b9997['register'](this[_0x2d30('0x13')],_0x5b42c6);}['_initThrowingOnDataSet'](){const _0x246471=this[_0x2d30('0x56')]['data'][_0x2d30('0x2c')];this[_0x2d30('0x56')][_0x2d30('0x16')][_0x2d30('0x2c')]=(..._0x3db0a0)=>{if(!_0x3db0a0[_0x3db0a0['length']-0x1][_0x2d30('0x3d')])throw new _0x536333(_0x2d30('0x45'),this);_0x246471[_0x2d30('0xa4')](this[_0x2d30('0x56')][_0x2d30('0x16')],_0x3db0a0);};}[_0x2d30('0x48')](){this[_0x2d30('0x56')][_0x2d30('0x16')]['on'](_0x2d30('0xf'),(_0x20f476,[_0x265772])=>{if(this['_document']['version'])throw new _0x536333('realtimecollaborationclient-init-document-already-initialized',this);_0x20f476['stop'](),this[_0x2d30('0xa1')]();const _0x43e92c=this[_0x2d30('0x47')](_0x265772);_0x20f476[_0x2d30('0xc0')]=this[_0x2d30('0x54')](_0x43e92c)[_0x2d30('0xaf')](()=>{this[_0x2d30('0x56')][_0x2d30('0x16')]['fire'](_0x2d30('0x90'));})[_0x2d30('0x87')](_0x5f3262=>this[_0x2d30('0x5b')](_0x2d30('0x9b'),_0x5f3262))['finally'](()=>this[_0x2d30('0x91')]());},{'priority':'high'});}[_0x2d30('0x50')](_0x86b142){const _0x77fd7d=this['editor']['plugins'][_0x2d30('0x6a')](_0x42fea8),{connection:_0xcf6477}=this['editor'][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x3f8da5),_0x527216=new Set();for(const _0xa4e2c4 of _0x86b142)_0x4de2f3(_0xa4e2c4[_0x2d30('0x49')]);return Promise['all'](Array[_0x2d30('0x5d')](_0x527216,async _0x2bd8bc=>{const _0x1a1946=await _0x1d24e4['get'](_0xcf6477,_0x2bd8bc);_0x77fd7d[_0x2d30('0x7')](_0x2bd8bc)||_0x77fd7d[_0x2d30('0x1')](_0x1a1946);}));function _0x4de2f3(_0x293d8c){_0x293d8c&&!_0x77fd7d[_0x2d30('0x7')](_0x293d8c)&&_0x527216[_0x2d30('0x70')](_0x293d8c);}}[_0x2d30('0x47')](_0x2d21a0){const _0x40d4ec=this['editor'][_0x2d30('0xba')],_0x582ffc=[];let _0x1877ad=0x0;const _0x1df606=_0x2d30('0x75')==typeof _0x2d21a0?{'main':_0x2d21a0}:_0x2d21a0;for(const _0x395c07 of Object[_0x2d30('0xc3')](_0x1df606)){if(!this['_document'][_0x2d30('0xa9')][_0x2d30('0x2e')](_0x395c07))throw new _0x536333(_0x2d30('0x86'),this);const _0x261ccc=this[_0x2d30('0x56')][_0x2d30('0x16')][_0x2d30('0xb2')](_0x1df606[_0x395c07]),_0x1c1c8e=this[_0x2d30('0xa7')][_0x2d30('0x25')](_0x395c07),_0x5522b6=new _0x173898(_0x40d4ec[_0x2d30('0x21')](_0x1c1c8e,0x0),_0x261ccc,_0x1877ad++);_0x582ffc['push'](_0x5522b6);for(const [_0x245d9e,_0xa5be8b]of _0x261ccc['markers']){const _0x598bdb=_0x40d4ec['createRange'](_0x40d4ec[_0x2d30('0x1c')](_0x1c1c8e,_0xa5be8b[_0x2d30('0x82')][_0x2d30('0x6b')][_0x2d30('0xb4')]()),_0x40d4ec[_0x2d30('0x1c')](_0x1c1c8e,_0xa5be8b['end'][_0x2d30('0x6b')][_0x2d30('0xb4')]())),_0x1e4b83=new _0x576ac8(_0x245d9e,null,_0x598bdb,_0x40d4ec[_0x2d30('0xa3')],!0x0,_0x1877ad++);_0x582ffc[_0x2d30('0x80')](_0x1e4b83);}}return _0x582ffc;}async[_0x2d30('0x8')](_0x1f7ebe,_0x27d6fe){let _0x165295;this[_0x2d30('0xaa')]=_0x1f7ebe['offset'];const _0x17e3b0=_0x1f7ebe[_0x2d30('0x85')]&&!_0x1f7ebe[_0x2d30('0x98')],_0xef4b87=_0x17e3b0?0x0:_0x1f7ebe[_0x2d30('0x16')][_0x2d30('0x26')];if(_0x17e3b0)_0x165295=_0x27d6fe,_0x165295[_0x2d30('0xae')](_0x1cab24=>{_0x1cab24[_0x2d30('0x37')]=_0x1f7ebe[_0x2d30('0x4d')],_0x1cab24['_isInit']=!0x0,_0x1cab24['_authorId']=null;}),this[_0x2d30('0x7b')](_0x165295,_0x17e3b0);else{if(_0x1f7ebe[_0x2d30('0x98')]){const _0x31579e=this[_0x2d30('0x47')](_0x1f7ebe[_0x2d30('0x98')]);this['_document'][_0x2d30('0x9')][_0x2d30('0x8d')]=-_0x31579e[_0x2d30('0x62')],_0x31579e[_0x2d30('0xae')](_0x3f3b99=>{_0x3f3b99['baseVersion']-=_0x31579e[_0x2d30('0x62')],_0x3f3b99[_0x2d30('0x37')]=_0x1f7ebe[_0x2d30('0x4d')],_0x3f3b99[_0x2d30('0xa')]=!0x0,_0x3f3b99[_0x2d30('0x49')]=null;}),this['_applyOperationsSet'](_0x31579e,!0x0),this[_0x2d30('0x83')][_0x2d30('0x8d')]=-_0x31579e[_0x2d30('0x62')]+this[_0x2d30('0xaa')],this[_0x2d30('0x3f')](_0x31579e);}this[_0x2d30('0xa7')][_0x2d30('0x9')]['version']=_0xef4b87,_0x165295=this['_decompressOperations'](_0x1f7ebe['data'],_0x1f7ebe[_0x2d30('0x88')]),await this[_0x2d30('0x50')](_0x165295),this[_0x2d30('0x7b')](_0x165295,_0x17e3b0);}_0x1f7ebe[_0x2d30('0x4b')]&&(this[_0x2d30('0x4f')][_0x2d30('0x58')](_0x165295,_0x1f7ebe[_0x2d30('0x4b')]),this['_lastSyncedOperationId']=_0x1f7ebe[_0x2d30('0x4b')]),this[_0x2d30('0x83')][_0x2d30('0x8d')]=_0xef4b87+this[_0x2d30('0xaa')],this['_updateServerHistory'](_0x165295);}[_0x2d30('0x5b')](_0xd0dab1,_0x357922){throw this[_0x2d30('0x66')]=!0x0,_0x357922&&console['error'](_0x357922),new _0x536333(_0xd0dab1,this[_0x2d30('0x56')]);}['_saveOperationInBuffer'](_0x547609){this['_knownOperations'][_0x2d30('0x2e')](_0x547609)||(this[_0x2d30('0xa6')]['add'](_0x547609),this[_0x2d30('0x81')][_0x2d30('0x80')](_0x547609),this['_pendingAction']||_0x2d30('0x5f')==_0x547609[_0x2d30('0xbc')]&&!_0x547609[_0x2d30('0x35')]||this['_setPendingAction']());}[_0x2d30('0x1d')](_0x51ead9=!0x1){!_0x51ead9&&this[_0x2d30('0x66')]||(this[_0x2d30('0x66')]=!0x0,clearTimeout(this[_0x2d30('0x19')]),this[_0x2d30('0x19')]=setTimeout(()=>{this['_sendBufferedOperations']()['then'](_0x55fec9=>{_0x55fec9&&(this[_0x2d30('0x91')](),this['_isPendingUpdate']=!0x1);})['catch'](_0x5f15a9=>{if(this[_0x2d30('0x91')](),this[_0x2d30('0x66')]=!0x1,!function(_0x21317f){return _0x21317f[_0x2d30('0x57')][_0x2d30('0xb1')](_0x2d30('0xb3'))||_0x21317f[_0x2d30('0x57')][_0x2d30('0xb1')](_0x2d30('0x4'))||_0x21317f[_0x2d30('0x57')][_0x2d30('0xb1')](_0x2d30('0x9c'));}(_0x5f15a9))throw _0x5f15a9;});},this[_0x2d30('0x33')]));}async[_0x2d30('0x34')](){const _0x1c143d=this[_0x2d30('0x56')][_0x2d30('0x8c')]['get'](_0x30afe9);if(this[_0x2d30('0x40')]()&&(_0x1c143d[_0x2d30('0x8e')](),this[_0x2d30('0x3a')]=!0x1),!this[_0x2d30('0x72')]())return!0x0;const _0x5d4adf=[...this['_bufferedOperations']];for(const _0x5edce3 of _0x5d4adf)_0x5edce3[_0x2d30('0x64')]=this['_document']['history']['isUndoneOperation'](_0x5edce3);const _0x5bda96=this[_0x2d30('0x4f')][_0x2d30('0x60')](_0x5d4adf),_0x4ea96e=Q++,_0x349c12=this[_0x2d30('0x32')](_0x5d4adf),_0x31f844=await this[_0x2d30('0xb6')][_0x2d30('0x99')](_0x349c12,_0x349c12['baseVersion'],_0x5bda96);try{return await this[_0x2d30('0xb9')](_0x5d4adf,_0x31f844,_0x4ea96e);}catch(_0x465383){return this[_0x2d30('0x5b')](_0x2d30('0xb8'),_0x465383);}}async[_0x2d30('0xb9')](_0x16703d,_0x4f16d3,_0x3d4f1c){if(_0x4f16d3[_0x2d30('0x89')])throw _0x4f16d3['error'];let _0x20abc9=!0x1;if(_0x4f16d3['wereChangesApplied']){_0x4f16d3[_0x2d30('0x4b')]&&(this[_0x2d30('0x20')]=_0x4f16d3[_0x2d30('0x4b')]),this[_0x2d30('0x81')]=this[_0x2d30('0x81')]['filter'](_0x6d1561=>!_0x16703d[_0x2d30('0xb7')](_0x6d1561));for(const _0x26739f of _0x16703d)_0x26739f[_0x2d30('0x37')]=_0x4f16d3[_0x2d30('0x94')];this[_0x2d30('0x3f')](_0x16703d),_0x20abc9=!0x0,this[_0x2d30('0x33')]=this['_baseBufferDelay'];}else{const _0x24986d=this['_decompressOperations'](_0x4f16d3[_0x2d30('0x16')],_0x4f16d3['metadata'])['filter'](_0x3b7d36=>_0x3b7d36['baseVersion']>=this[_0x2d30('0x1b')]);await this['_fetchMissingUsers'](_0x24986d),_0x20abc9=this[_0x2d30('0x79')](_0x24986d,_0x4f16d3['version'],_0x4f16d3[_0x2d30('0x4b')]),this[_0x2d30('0x33')]=Math[_0x2d30('0xa0')](this[_0x2d30('0x33')]/0x2);}return _0x20abc9?!this['_shouldSendUpdate']()||(this[_0x2d30('0x1d')](!0x0),!0x1):this[_0x2d30('0x5b')](_0x2d30('0xa5'));}[_0x2d30('0x79')](_0x564de2,_0x3a6650,_0x22f073){try{const _0x550a2d={'document':this[_0x2d30('0xa7')],'useRelations':!0x1,'padWithNoOps':!0x0},{operationsA:_0x16b1a6,operationsB:_0x3ae56c,originalOperations:_0x20fad9}=_0x1e7ecc(_0x564de2,this[_0x2d30('0x81')],_0x550a2d);Y(_0x16b1a6,this['_document']['version']),Y(_0x3ae56c,_0x3a6650);for(const _0x4c4c29 of _0x16b1a6){const _0x5ef6ad=_0x20fad9[_0x2d30('0x6a')](_0x4c4c29);_0x4c4c29['_authorId']=_0x5ef6ad?_0x5ef6ad[_0x2d30('0x49')]:null;}_0x22f073&&(this[_0x2d30('0x4f')]['setIdForTheLastOperation'](_0x564de2,_0x22f073),this['_lastSyncedOperationId']=_0x22f073),this[_0x2d30('0x81')]=[..._0x3ae56c],this[_0x2d30('0x7b')](_0x16b1a6),this['_updateServerHistory'](_0x564de2);}catch(_0x24e9cb){return console['error'](_0x24e9cb),!0x1;}return!0x0;}['_applyOperationsSet'](_0x24434c,_0x1416eb=!0x1){this[_0x2d30('0x56')][_0x2d30('0xba')][_0x2d30('0x6')]({'isUndoable':!0x1,'isLocal':!0x1},_0x10b56b=>{for(const _0x5ccc08 of _0x24434c)this[_0x2d30('0xa6')]['add'](_0x5ccc08),_0x10b56b[_0x2d30('0x7d')][_0x2d30('0xac')](_0x5ccc08),this[_0x2d30('0x56')][_0x2d30('0xba')]['applyOperation'](_0x5ccc08);});}[_0x2d30('0x3f')](_0x1e8c44){_0x1e8c44['forEach'](_0x4cca2d=>{const _0x4e2e83=_0x4cca2d[_0x2d30('0x84')]();_0x4e2e83['_authorId']=_0x4cca2d['_authorId'],_0x4e2e83[_0x2d30('0xa')]=!!_0x4cca2d['_isInit'],_0x4e2e83[_0x2d30('0x37')]=_0x4cca2d['createdAt'],_0x4e2e83['baseVersion']+=this[_0x2d30('0xaa')],_0x4cca2d['_isDisconnection']&&this[_0x2d30('0xb0')]['add'](_0x4e2e83),this['serverHistory'][_0x2d30('0xac')](_0x4e2e83);});}[_0x2d30('0xbd')](_0x2ec464){const _0x3a7dab=this[_0x2d30('0x56')][_0x2d30('0x8c')][_0x2d30('0x6a')]('Notification'),_0x4d5d6b=this[_0x2d30('0x56')][_0x2d30('0x2d')];_0x2ec464||(_0x2ec464=_0x1fd8b8(_0x4d5d6b,_0x2d30('0x5'))),_0x3a7dab[_0x2d30('0x22')](_0x2ec464,{'title':_0x1fd8b8(_0x4d5d6b,'Synchronization\x20issue'),'namespace':'real-time-collaboration'}),this[_0x2d30('0x24')]=!0x0,clearTimeout(this[_0x2d30('0x19')]),this[_0x2d30('0x81')]=[],this[_0x2d30('0x56')]['plugins'][_0x2d30('0x6a')](_0x3f8da5)['destroy']();}[_0x2d30('0xa1')](){this[_0x2d30('0x7a')]||(this[_0x2d30('0x7a')]=this[_0x2d30('0x56')]['plugins'][_0x2d30('0x6a')](_0x164be4)[_0x2d30('0x70')](_0x1fd8b8(this[_0x2d30('0x56')][_0x2d30('0x2d')],_0x2d30('0x4e'))));}[_0x2d30('0x91')](){this['_pendingAction']&&(this[_0x2d30('0x56')][_0x2d30('0x8c')][_0x2d30('0x6a')](_0x164be4)[_0x2d30('0x92')](this[_0x2d30('0x7a')]),this[_0x2d30('0x7a')]=null);}[_0x2d30('0x32')](_0x17beed){const _0x5a0df0=_0x17beed['map'](_0x192396=>_0x192396[_0x2d30('0x78')]());return this['_compressor'][_0x2d30('0x6f')](_0x5a0df0);}[_0x2d30('0xa2')](_0x23bd8a,_0x2582d7){const _0x176369=this[_0x2d30('0x3b')][_0x2d30('0xad')](_0x23bd8a)[_0x2d30('0x36')]((_0x238145,_0x3d0ef5)=>{const _0x5a5ed7=_0x9cf77c[_0x2d30('0x39')](_0x238145,this[_0x2d30('0xa7')]);return _0x5a5ed7[_0x2d30('0x64')]=_0x238145[_0x2d30('0x64')],_0x2d30('0x3e')===_0x2582d7[_0x3d0ef5]['type']&&(_0x5a5ed7[_0x2d30('0x11')]=!0x0),_0x5a5ed7;});return this[_0x2d30('0x3c')](_0x176369,_0x2582d7),_0x176369;}[_0x2d30('0x3c')](_0x3baf9c,_0x2380df){for(let _0x51eb5b=0x0;_0x51eb5b<_0x3baf9c[_0x2d30('0x62')];_0x51eb5b++)_0x2d30('0xf')==_0x2380df[_0x51eb5b][_0x2d30('0xbc')]?(_0x3baf9c[_0x51eb5b][_0x2d30('0xa')]=!0x0,_0x3baf9c[_0x51eb5b][_0x2d30('0x49')]=null):(_0x3baf9c[_0x51eb5b][_0x2d30('0xa')]=!0x1,_0x3baf9c[_0x51eb5b][_0x2d30('0x49')]=_0x2380df[_0x51eb5b][_0x2d30('0x1f')]),_0x3baf9c[_0x51eb5b]['createdAt']=_0x2380df[_0x51eb5b][_0x2d30('0x37')];}['_refreshUserSelectionMarkers'](){this[_0x2d30('0x3a')]=!0x0,this['_shouldSendSelectionUpdate']()&&this[_0x2d30('0x1d')]();}[_0x2d30('0x40')](){const _0x2440b5=this[_0x2d30('0x56')]['plugins'][_0x2d30('0x6a')](_0x4e5a25)[_0x2d30('0x5c')][_0x2d30('0x6a')](this[_0x2d30('0x13')]);return!this[_0x2d30('0x56')][_0x2d30('0xb5')]&&_0x2440b5&&_0x2440b5[_0x2d30('0x62')]>0x1&&this[_0x2d30('0x3a')];}[_0x2d30('0x72')](){return this[_0x2d30('0x81')]['length']>0x0||this['_shouldSendSelectionUpdate']();}}class X extends Error{}function Y(_0x5b0a41,_0x3ed872){for(const _0x1d25e0 of _0x5b0a41)_0x1d25e0[_0x2d30('0x26')]=_0x3ed872++;}l[_0x2d30('0xc2')]=_0x575cd8;class Z{constructor(_0x41e2ce){this['_ignoredOperations']=_0x41e2ce,this[_0x2d30('0x59')]=new WeakMap();}[_0x2d30('0x60')](_0x1a24ff){let _0x795158=_0x1a24ff['length'];for(;_0x795158--;){const _0x2d6267=_0x1a24ff[_0x795158];if(!this[_0x2d30('0xd')]['has'](_0x2d6267)){if(!this[_0x2d30('0x59')]['has'](_0x2d6267)){const _0x54369a=_0x397a33()[_0x2d30('0xb4')](0x1,0x12);this[_0x2d30('0x59')][_0x2d30('0x2c')](_0x2d6267,_0x54369a);}return this[_0x2d30('0x59')]['get'](_0x2d6267);}}}['setIdForTheLastOperation'](_0x1a3f15,_0x363da2){if(!_0x363da2)return;let _0x32791a=_0x1a3f15[_0x2d30('0x62')];for(;_0x32791a--;){const _0x42f1b6=_0x1a3f15[_0x32791a];this[_0x2d30('0xd')]['has'](_0x42f1b6)||this['_operationToId'][_0x2d30('0x2c')](_0x42f1b6,_0x363da2);}}}