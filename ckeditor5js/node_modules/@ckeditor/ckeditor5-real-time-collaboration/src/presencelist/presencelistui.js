/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x4248=['isHidden','_allConnectedUsers','detachFromDom','listenTo','hideDropdown','destroy','element','context','bindTo','isCollapsed','usersCount','config','init','remove','presenceList','define','class','view','execute','presencelist-collapseat-invalid-format','presenceList.container','from','presencelist-missing-container','get','_handleUserAdd','allConnectedUsers','onClick','render','using','content','presenceDropdownView','plugins','_handleUserRemove','number','add','ck\x20ck-presence-list__balloon','isVisible','locale','length','showDropdown','balloonPanelView','bodyCollection','presenceList.collapseAt','inlineListView','appendChild','_createView','attachToDom','counterView','lastConnectedUsers','reverse'];(function(_0x114150,_0x424884){const _0x265f3e=function(_0xc0fa2c){while(--_0xc0fa2c){_0x114150['push'](_0x114150['shift']());}};_0x265f3e(++_0x424884);}(_0x4248,0xac));const _0x265f=function(_0x114150,_0x424884){_0x114150=_0x114150-0x0;let _0x265f3e=_0x4248[_0x114150];return _0x265f3e;};import{ContextPlugin as _0x3cf98d}from'ckeditor5/src/core';import{CKEditorError as _0x686f0,Collection as _0x12ee71}from'ckeditor5/src/utils';import{clickOutsideHandler as _0x3d97c3,BodyCollection as _0xc64c90,BalloonPanelView as _0x796c65}from'ckeditor5/src/ui';import{isElement as _0x2e0be6}from'lodash-es';import _0x57c8e5 from'../realtimecollaborativeediting/sessions';import _0x230f45 from'./view/presencelistview';import _0x1242ce from'./view/presencedropdownlistview';import _0x45b712 from'./view/presencedropdownlistitemview';import _0x576641 from'./view/presenceinlinelistitemview';export default class i extends _0x3cf98d{constructor(_0xb44c1){super(_0xb44c1),_0xb44c1[_0x265f('0x27')][_0x265f('0x2b')]('presenceList',{'collapseAt':0x6});const _0x3c8af1=_0xb44c1['config'][_0x265f('0x1')]('presenceList.collapseAt');if(_0x265f('0xb')!=typeof _0x3c8af1)throw new _0x686f0('presencelist-collapseat-invalid-format',this);if(_0x3c8af1<0x1)throw new _0x686f0(_0x265f('0x2f'),this);}static get['requires'](){return[_0x57c8e5];}[_0x265f('0x28')](){const _0x28bf41=this['context'];this[_0x265f('0x1d')]=_0x28bf41[_0x265f('0x9')][_0x265f('0x1')](_0x57c8e5)[_0x265f('0x3')],this['set']('usersCount',0x0),this['lastConnectedUsers']=new _0x12ee71(),this[_0x265f('0x12')]=new _0x796c65(),this['balloonPanelView'][_0x265f('0x2c')]=_0x265f('0xd'),this[_0x265f('0x2d')]=this[_0x265f('0x17')](),this['presenceDropdownView']=void 0x0;for(const _0x5034d7 of this[_0x265f('0x1d')])this[_0x265f('0x2')](_0x5034d7);this['listenTo'](this['_allConnectedUsers'],_0x265f('0xc'),(_0x586e82,_0x2ef6d7)=>{this[_0x265f('0x2')](_0x2ef6d7);}),this[_0x265f('0x1f')](this[_0x265f('0x1d')],_0x265f('0x29'),(_0x59da7f,_0x4790c2)=>{this[_0x265f('0xa')](_0x4790c2);});}[_0x265f('0x17')](){const _0x409da8=this['context'],_0x17593b=new _0x230f45(this['context'][_0x265f('0xf')]),_0x452dce=this[_0x265f('0x12')];if(!_0x2e0be6(_0x409da8[_0x265f('0x27')][_0x265f('0x1')](_0x265f('0x30'))))throw new _0x686f0(_0x265f('0x0'),this);return _0x17593b[_0x265f('0x19')]['bind'](_0x265f('0x26'))['to'](this),_0x17593b['bind'](_0x265f('0x25'))['to'](this,'usersCount',_0x2bc230=>{const _0x106c77=_0x2bc230>=_0x409da8[_0x265f('0x27')][_0x265f('0x1')](_0x265f('0x14'));return _0x17593b[_0x265f('0x19')][_0x265f('0x1c')]=!(0x1==_0x2bc230||_0x106c77),_0x106c77||this[_0x265f('0x20')](),_0x106c77;}),_0x17593b[_0x265f('0x15')]['items'][_0x265f('0x24')](this[_0x265f('0x1a')])[_0x265f('0x6')](_0x1776da=>{const _0x13c3ac=_0x409da8[_0x265f('0x27')][_0x265f('0x1')](_0x265f('0x2a')),_0x4710fe=new _0x576641(_0x409da8['locale'],_0x1776da,_0x13c3ac[_0x265f('0x4')]);return _0x13c3ac[_0x265f('0x4')]&&this[_0x265f('0x1f')](_0x4710fe,_0x265f('0x2e'),()=>{this['view'][_0x265f('0x25')]||_0x13c3ac[_0x265f('0x4')](_0x1776da,_0x4710fe[_0x265f('0x22')]);}),_0x4710fe;}),this[_0x265f('0x1f')](_0x17593b[_0x265f('0x15')],'execute',()=>{this['presenceDropdownView']?this[_0x265f('0x20')]():this['view'][_0x265f('0x25')]&&this[_0x265f('0x11')]();}),_0x17593b[_0x265f('0x5')](),_0x452dce['render'](),_0x3d97c3({'emitter':_0x17593b,'activator':()=>_0x452dce[_0x265f('0xe')],'contextElements':[_0x452dce[_0x265f('0x22')],_0x17593b[_0x265f('0x15')]['element']],'callback':()=>this[_0x265f('0x20')]()}),_0x409da8[_0x265f('0x27')][_0x265f('0x1')](_0x265f('0x30'))[_0x265f('0x16')](_0x17593b[_0x265f('0x22')]),this['bodyCollection']=new _0xc64c90(this['context']['locale']),this[_0x265f('0x13')][_0x265f('0x18')](),this[_0x265f('0x13')][_0x265f('0xc')](_0x452dce),_0x17593b;}[_0x265f('0x2')](_0x32c767){this['usersCount']++,0x5==this[_0x265f('0x1a')][_0x265f('0x10')]&&this[_0x265f('0x1a')][_0x265f('0x29')](0x0),this['lastConnectedUsers'][_0x265f('0xc')](_0x32c767);}[_0x265f('0xa')](_0x25c294){if(this[_0x265f('0x26')]--,this[_0x265f('0x1a')][_0x265f('0x1')](_0x25c294['id'])&&(this[_0x265f('0x1a')][_0x265f('0x29')](_0x25c294['id']),this[_0x265f('0x1a')][_0x265f('0x10')]<this[_0x265f('0x26')]))for(const _0xaf023d of Array[_0x265f('0x31')](this[_0x265f('0x1d')])[_0x265f('0x1b')]())if(!this[_0x265f('0x1a')]['get'](_0xaf023d['id']))return void this['lastConnectedUsers'][_0x265f('0xc')](_0xaf023d,0x0);}['showDropdown'](){if(this[_0x265f('0x8')])return;this['presenceDropdownView']=new _0x1242ce();const _0x4982ed=this['context']['config'][_0x265f('0x1')](_0x265f('0x2a'));this[_0x265f('0x8')]['items'][_0x265f('0x24')](this[_0x265f('0x1d')])[_0x265f('0x6')](_0x27684d=>{const _0x5df0c7=new _0x45b712(this[_0x265f('0x23')][_0x265f('0xf')],_0x27684d,!!_0x4982ed['onClick']);return _0x4982ed['onClick']&&this['listenTo'](_0x5df0c7,_0x265f('0x2e'),()=>{_0x4982ed[_0x265f('0x4')](_0x27684d,_0x5df0c7[_0x265f('0x22')]);}),_0x5df0c7;}),this['balloonPanelView'][_0x265f('0x7')]['add'](this[_0x265f('0x8')]),this[_0x265f('0x12')]['pin']({'target':this[_0x265f('0x2d')][_0x265f('0x15')][_0x265f('0x22')]});}[_0x265f('0x20')](){this[_0x265f('0x8')]&&(this[_0x265f('0x12')]['unpin'](),this[_0x265f('0x12')]['content'][_0x265f('0x29')](this['presenceDropdownView']),this[_0x265f('0x8')]['destroy'](),this[_0x265f('0x8')]=void 0x0);}[_0x265f('0x21')](){super[_0x265f('0x21')](),this[_0x265f('0x2d')]&&this['view']['isRendered']&&this[_0x265f('0x2d')][_0x265f('0x21')](),this['bodyCollection']&&this[_0x265f('0x13')][_0x265f('0x1e')]();}}