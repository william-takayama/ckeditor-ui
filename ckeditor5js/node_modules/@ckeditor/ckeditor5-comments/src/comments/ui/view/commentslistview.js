/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0xfe39=['_model','maxThreadTotalWeight','editorConfig','change:hasDirtyComment','_config','_handleRemoveCommentModel','insert','render','commentViews','change:isActive','isEditMode','stopListening','formatDateTime','weight','get','delete','from','length','visibleViews','_handleNewCommentModel','equal','_rearrangeExpand','_collapsedCommentsView','set','listenTo','destroy','refreshVisibleViews','maxCommentsWhenCollapsed','_rearrangeCollapse','ck-thread__comments','_updateHasDirtyComment','change:isEditMode','viewUid','hasDirtyComment','comments','add','remove','focus','createCollection','delegate','_shouldCollapse','count','isActive'];(function(_0x3deabc,_0xfe39a1){const _0x5ea267=function(_0x5b0edb){while(--_0x5b0edb){_0x3deabc['push'](_0x3deabc['shift']());}};_0x5ea267(++_0xfe39a1);}(_0xfe39,0x168));const _0x5ea2=function(_0x3deabc,_0xfe39a1){_0x3deabc=_0x3deabc-0x0;let _0x5ea267=_0xfe39[_0x3deabc];return _0x5ea267;};import{View as _0x4dfe29}from'ckeditor5/src/ui';import{diff as _0x57ea00,Collection as _0x119050}from'ckeditor5/src/utils';import _0x102404 from'./collapsedcommentsview';export default class ct extends _0x4dfe29{constructor(_0x204ecb,_0x345055,_0x2df68f){super(_0x204ecb),this[_0x5ea2('0x7')]('hasDirtyComment',!0x1),this[_0x5ea2('0x7')](_0x5ea2('0x1'),_0x345055['comments'][_0x5ea2('0x1')]),this[_0x5ea2('0x7')](_0x5ea2('0x1a'),!0x1),this[_0x5ea2('0x1b')]=_0x345055,this[_0x5ea2('0x1f')]=_0x2df68f,this[_0x5ea2('0x23')]=this[_0x5ea2('0x16')](),this['visibleViews']=this[_0x5ea2('0x16')](),this[_0x5ea2('0x6')]=new _0x102404(_0x204ecb),this[_0x5ea2('0x6')]['bind'](_0x5ea2('0x19'))['to'](this,'length',_0x41adf2=>_0x41adf2-this[_0x5ea2('0x1f')][_0x5ea2('0xb')]);for(const _0x278810 of _0x345055[_0x5ea2('0x12')])this[_0x5ea2('0x3')](_0x278810);this['listenTo'](_0x345055[_0x5ea2('0x12')],_0x5ea2('0x13'),(_0x1e82aa,_0x10c9ab)=>{this[_0x5ea2('0x1')]++,this[_0x5ea2('0x3')](_0x10c9ab),this['refreshVisibleViews']();}),this['listenTo'](_0x345055['comments'],_0x5ea2('0x14'),(_0x367ae9,_0x8b4a24)=>{this[_0x5ea2('0x1')]--,this[_0x5ea2('0x20')](_0x8b4a24),this[_0x5ea2('0xa')]();}),this['listenTo'](_0x345055,'commentUpdated',()=>this['refreshVisibleViews']()),this['on'](_0x5ea2('0x24'),()=>this[_0x5ea2('0xa')]()),this['on'](_0x5ea2('0x1e'),()=>this['refreshVisibleViews']()),this['setTemplate']({'tag':'ul','attributes':{'class':[_0x5ea2('0xd')]},'children':this[_0x5ea2('0x2')]});}get['_shouldCollapse'](){return this[_0x5ea2('0x1b')][_0x5ea2('0x28')]>this[_0x5ea2('0x1f')][_0x5ea2('0x1c')]&&!this['isActive']&&!this['hasDirtyComment'];}[_0x5ea2('0x22')](){super[_0x5ea2('0x22')](),this[_0x5ea2('0xa')]();}[_0x5ea2('0x15')](){this['element']['focus']();}[_0x5ea2('0x9')](){this[_0x5ea2('0x6')][_0x5ea2('0x9')]();for(const _0x522100 of this['commentViews'])_0x522100[_0x5ea2('0x9')]();super[_0x5ea2('0x9')]();}[_0x5ea2('0xa')](){this[_0x5ea2('0x18')]?this[_0x5ea2('0xc')]():this[_0x5ea2('0x5')]();}['_handleNewCommentModel'](_0x506d83){const _0x5afb66=new this['_config']['CommentView'](this['locale'],_0x506d83,{'maxCommentCharsWhenCollapsed':this[_0x5ea2('0x1f')]['maxCommentCharsWhenCollapsed'],'formatDateTime':this[_0x5ea2('0x1f')][_0x5ea2('0x27')],'editorConfig':this[_0x5ea2('0x1f')][_0x5ea2('0x1d')]});_0x5afb66[_0x5ea2('0x10')]=_0x506d83['id'],_0x5afb66[_0x5ea2('0x17')]('removeComment')['to'](this),_0x5afb66[_0x5ea2('0x17')]('updateComment')['to'](this),this[_0x5ea2('0x8')](_0x5afb66,_0x5ea2('0xf'),()=>this[_0x5ea2('0xe')]()),this[_0x5ea2('0x23')][_0x5ea2('0x13')](_0x5afb66);}[_0x5ea2('0x20')](_0x26dccb){const _0x586592=this[_0x5ea2('0x23')]['remove'](_0x26dccb['id']);this[_0x5ea2('0x26')](_0x586592),_0x586592[_0x5ea2('0x25')]&&this['_updateHasDirtyComment'](),_0x586592['destroy']();}[_0x5ea2('0xe')](){this[_0x5ea2('0x11')]=Array[_0x5ea2('0x0')](this[_0x5ea2('0x23')])['some'](_0xf9b0e7=>_0xf9b0e7[_0x5ea2('0x25')]);}['_rearrangeCollapse'](){const _0x32eed9=function(_0x4ddfa6){const _0x2b728c=new _0x119050();for(const _0x3910f8 of _0x4ddfa6)_0x2b728c[_0x5ea2('0x13')](_0x3910f8);return _0x2b728c;}(this[_0x5ea2('0x23')]),_0x42af8e=this[_0x5ea2('0x6')][_0x5ea2('0x19')];for(let _0x8fd3ca=0x1;_0x8fd3ca<=_0x42af8e;_0x8fd3ca++)_0x32eed9[_0x5ea2('0x14')](0x1);for(const _0x3c52b6 of _0x32eed9)_0x3c52b6['collapse']();_0x42af8e>0x0&&_0x32eed9['add'](this['_collapsedCommentsView'],0x1),Ut(_0x57ea00(Array['from'](this[_0x5ea2('0x2')]),Array[_0x5ea2('0x0')](_0x32eed9)),this[_0x5ea2('0x2')],_0x32eed9);}[_0x5ea2('0x5')](){Ut(_0x57ea00(Array[_0x5ea2('0x0')](this['visibleViews']),Array[_0x5ea2('0x0')](this[_0x5ea2('0x23')])),this[_0x5ea2('0x2')],this['commentViews']);for(const _0x2adc08 of this[_0x5ea2('0x2')])_0x2adc08['expand']();}}function Ut(_0x2e26fa,_0x43fb20,_0x402904){let _0x4b489d=0x0;for(const _0x214fe3 of _0x2e26fa)switch(_0x214fe3){case _0x5ea2('0x21'):_0x43fb20['add'](_0x402904[_0x5ea2('0x29')](_0x4b489d),_0x4b489d),_0x4b489d++;break;case _0x5ea2('0x2a'):_0x43fb20['remove'](_0x4b489d);break;case _0x5ea2('0x4'):_0x4b489d++;}}