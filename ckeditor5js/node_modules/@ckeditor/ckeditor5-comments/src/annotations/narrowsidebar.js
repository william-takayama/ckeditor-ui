/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x4fcc=['_detachListeners','delete','off','_manuallyClosedAnnotationViews','change:height','includes','Sidebar','setActiveAnnotation','has','ready','stop','attachToDom','bind','balloonPanelView','northArrowSouthWest','EditorAnnotations','narrowsidebar-attach-already-attached','getByView','type','addEventListener','narrowSidebar','annotations','_attachToContainer','plugins','clear','ck-sidebar--narrow','high','view','activeAnnotation','_updateBalloonPosition','set:container','_hideBalloon','_selectedAnnotations','bodyCollection','execute','_domEmitter','pluginName','contains','_setSelectedAnnotations','focus','context','defaultPositions','stopListening','add','isVisible','editors','isDirty','removeEventListener','_attachListeners','attach','keyCode','values','get','register','set','esc','detach','southArrowNorthEast','_throttledRefreshPositioning','remove','_editorAnnotations','blur','_showBalloon','southArrowNorth','northArrowSouthEast','length','listenTo','stopPropagation','element','isAttached','number','preventDefault','detachFromDom','from','destroy','init','locale','refresh','_destroyEditorAnnotationsIntegration','resize','addAnnotation','NarrowSidebar','_refreshPositioning','mousedown','hasDomSelection','target','create','unpin','keydown','refreshPositioning','_annotationToNarrowView','first','content','narrowsidebar-detach-not-attached','_integrateWithEditorAnnotations'];(function(_0x1a21bb,_0x4fccab){const _0x162f73=function(_0x1cd84f){while(--_0x1cd84f){_0x1a21bb['push'](_0x1a21bb['shift']());}};_0x162f73(++_0x4fccab);}(_0x4fcc,0xd1));const _0x162f=function(_0x1a21bb,_0x4fccab){_0x1a21bb=_0x1a21bb-0x0;let _0x162f73=_0x4fcc[_0x1a21bb];return _0x162f73;};import{ContextPlugin as _0x56913a}from'ckeditor5/src/core';import _0x276ddc from'./annotationsuis';import _0x4a9b5c from'./sidebar';import _0x13b028 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x2912f0,BodyCollection as _0x12b8f8}from'ckeditor5/src/ui';import{CKEditorError as _0x22c5f1,DomEmitterMixin as _0x2e8ffa,keyCodes as _0x1045f7,Collection as _0x3c6ad5}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{throttle as _0x3e039e}from'lodash-es';export default class s extends _0x56913a{static get['requires'](){return[_0x4a9b5c,_0x276ddc];}static get[_0x162f('0x11')](){return _0x162f('0x3e');}constructor(_0x151c4a){super(_0x151c4a),this[_0x162f('0x32')]=!0x1,this[_0x162f('0x4f')]=new Set(),this[_0x162f('0x10')]=Object[_0x162f('0x43')](_0x2e8ffa),this[_0x162f('0x47')]=new Map(),this['set']('activeAnnotation',null),this[_0x162f('0x2')]=null,this[_0x162f('0xd')]=[],this[_0x162f('0x29')]=new _0x3c6ad5(),this['_throttledRefreshPositioning']=_0x3e039e(()=>{this[_0x162f('0x3f')]();},0x190,{'leading':!0x1});}[_0x162f('0x38')](){this[_0x162f('0x15')][_0x162f('0x4')][_0x162f('0x21')](_0x276ddc)[_0x162f('0x22')](_0x162f('0x1'),this),this[_0x162f('0xe')]=new _0x12b8f8(this[_0x162f('0x15')]['locale']),this[_0x162f('0x59')]=new _0x2912f0(this[_0x162f('0x15')][_0x162f('0x39')]),this[_0x162f('0xe')][_0x162f('0x57')](),this[_0x162f('0xe')][_0x162f('0x18')](this[_0x162f('0x59')]);}[_0x162f('0x1e')](_0x1477ab){this[_0x162f('0x2')]=_0x1477ab;const _0x25482c=this[_0x162f('0x15')][_0x162f('0x4')][_0x162f('0x21')](_0x4a9b5c),_0x2a07f0=this['balloonPanelView'];if(_0x25482c['_annotations']=_0x1477ab,this['isAttached'])throw new _0x22c5f1(_0x162f('0x5c'),this);this[_0x162f('0x32')]=!0x0,this[_0x162f('0x2f')](_0x25482c,_0x162f('0xb'),()=>{this[_0x162f('0x25')](),this['listenTo'](_0x25482c,'change:container',_0x573b06=>{_0x573b06[_0x162f('0x4e')](),this[_0x162f('0x1e')](_0x1477ab);});}),_0x25482c[_0x162f('0x3')]({'viewClass':_0x162f('0x6'),'spaceBetweenItems':0x5});const _0x44d374=_0x6e3875=>{const _0x376f16=new _0x13b028(this[_0x162f('0x15')]['locale']);_0x25482c[_0x162f('0x3d')](_0x6e3875,_0x376f16),this[_0x162f('0x47')][_0x162f('0x23')](_0x6e3875,_0x376f16),_0x376f16[_0x162f('0x58')](_0x162f('0x1b'),'annotationType',_0x162f('0x33'))['to'](_0x6e3875[_0x162f('0x8')],_0x162f('0x1b'),_0x162f('0x5e'),_0x162f('0x2e')),_0x376f16['on'](_0x162f('0xf'),()=>{this[_0x162f('0x4f')][_0x162f('0x5')](),_0x2a07f0[_0x162f('0x49')][_0x162f('0x48')]!==_0x6e3875[_0x162f('0x8')]?(this[_0x162f('0x2b')](_0x6e3875),_0x6e3875['view']['element'][_0x162f('0x14')](),this[_0x162f('0x53')](_0x6e3875)):this['setActiveAnnotation'](null);});};for(const _0x45cd94 of _0x1477ab)_0x44d374(_0x45cd94);this['listenTo'](_0x1477ab,'add',(_0x263800,_0x1bdbfe)=>{_0x44d374(_0x1bdbfe);}),this[_0x162f('0x2f')](_0x1477ab,'remove',(_0x35f392,_0x1d40a9,_0x3e475a)=>{this[_0x162f('0x47')][_0x162f('0x21')](_0x1d40a9)[_0x162f('0x37')](),this['_annotationToNarrowView'][_0x162f('0x4d')](_0x1d40a9),_0x25482c['rearrange']({'removedAnnotation':_0x1d40a9,'previousAnnotation':_0x1477ab[_0x162f('0x21')](_0x3e475a-0x1),'nextAnnotation':_0x1477ab[_0x162f('0x21')](_0x3e475a+0x1)}),_0x1d40a9===this[_0x162f('0x9')]&&this['setActiveAnnotation'](null);},{'priority':'low'}),this[_0x162f('0x2f')](_0x1477ab,_0x162f('0x14'),(_0x418d92,_0x5b05b4)=>{this[_0x162f('0x53')](_0x5b05b4);}),this[_0x162f('0x2f')](_0x1477ab,_0x162f('0x2a'),()=>{this[_0x162f('0x53')](null);}),this[_0x162f('0x10')][_0x162f('0x2f')](document,_0x162f('0x45'),(_0x5c7118,_0x135b6d)=>{_0x135b6d[_0x162f('0x1f')]===_0x1045f7[_0x162f('0x24')]&&_0x2a07f0['isVisible']&&(this['_manuallyClosedAnnotationViews'][_0x162f('0x18')](_0x2a07f0[_0x162f('0x49')]['first']),this['_hideBalloon'](),_0x135b6d[_0x162f('0x30')](),_0x135b6d[_0x162f('0x34')]());}),this[_0x162f('0x10')][_0x162f('0x2f')](document,_0x162f('0x40'),(_0x3b6b30,_0x5a83ab)=>{const _0x15749b=_0x5a83ab[_0x162f('0x42')];_0x2a07f0[_0x162f('0x19')]&&_0x2a07f0[_0x162f('0x31')][_0x162f('0x12')](_0x15749b)||_0x25482c[_0x162f('0x8')][_0x162f('0x31')][_0x162f('0x12')](_0x15749b)||_0x3b6b30['preventClosingBalloon']||(this[_0x162f('0x4f')]['clear'](),this['_hideBalloon'](),this[_0x162f('0x53')](null));});const _0x5ae632=this[_0x162f('0x15')][_0x162f('0x1a')]?this[_0x162f('0x15')][_0x162f('0x1a')]:new _0x3c6ad5([this['context']]);for(const _0xac17e0 of _0x5ae632)this[_0x162f('0x4b')](_0xac17e0);this['listenTo'](_0x5ae632,_0x162f('0x18'),(_0x56cefc,_0x23b8c2)=>{this[_0x162f('0x2f')](_0x23b8c2,_0x162f('0x55'),()=>{this['_integrateWithEditorAnnotations'](_0x23b8c2);});}),this[_0x162f('0x2f')](_0x5ae632,_0x162f('0x28'),(_0x5c4397,_0x5e9b51)=>{_0x5e9b51['plugins'][_0x162f('0x54')]('EditorAnnotations')&&this[_0x162f('0x3b')](_0x5e9b51['plugins'][_0x162f('0x21')]('EditorAnnotations'));}),window[_0x162f('0x0')](_0x162f('0x3c'),this['_throttledRefreshPositioning']),this[_0x162f('0x3f')]();}['setActiveAnnotation'](_0x761c47){if(_0x761c47===this['activeAnnotation'])return;const _0x21753d=this[_0x162f('0x15')][_0x162f('0x4')][_0x162f('0x21')](_0x162f('0x52'));if(_0x21753d[_0x162f('0x3a')]({'blurredAnnotation':this['activeAnnotation'],'activatedAnnotation':_0x761c47,'disableAnimationOnActivatedAnnotation':!0x0}),_0x761c47)_0x21753d['getSidebarItemView'](_0x761c47)?this[_0x162f('0x2b')](_0x761c47):this['_hideBalloon']();else this[_0x162f('0xc')]();this[_0x162f('0x9')]=_0x761c47;}[_0x162f('0x25')](){if(!this[_0x162f('0x32')])throw new _0x22c5f1(_0x162f('0x4a'),this);this[_0x162f('0x53')](null);const _0x15fa65=this[_0x162f('0x15')][_0x162f('0x4')]['get']('Sidebar');this[_0x162f('0xc')](),Array[_0x162f('0x36')](this[_0x162f('0x47')][_0x162f('0x20')](),_0x327875=>_0x327875[_0x162f('0x37')]()),this[_0x162f('0x47')]['clear'](),_0x15fa65['_detachFromContainer'](this[_0x162f('0x2')]),this['stopListening'](),this[_0x162f('0x10')][_0x162f('0x17')](),this[_0x162f('0x17')](this['context'][_0x162f('0x1a')]);for(const _0x2b3612 of Array[_0x162f('0x36')](this[_0x162f('0x29')]))this[_0x162f('0x3b')](_0x2b3612);window[_0x162f('0x1c')]('resize',this[_0x162f('0x27')]),this['_throttledRefreshPositioning']['cancel'](),this[_0x162f('0xd')]=[],this[_0x162f('0x32')]=!0x1,this['annotations']=null;}[_0x162f('0x37')](){this[_0x162f('0x32')]&&this['detach'](),this[_0x162f('0xe')][_0x162f('0x35')]();}[_0x162f('0x4b')](_0x19b9fe){const _0x2472db=_0x19b9fe[_0x162f('0x4')][_0x162f('0x21')](_0x162f('0x5b')),_0x3d705b=this[_0x162f('0x15')]['plugins'][_0x162f('0x21')](_0x4a9b5c),_0x33b963=this[_0x162f('0x2')],_0x1569d7=this[_0x162f('0x59')],_0x5cc6fe=()=>{const _0x429c49=_0x2472db['getOrderedSelectedAnnotations']({'activeAnnotation':this[_0x162f('0x9')],'annotations':this['annotations']});this['_setSelectedAnnotations'](_0x429c49),this[_0x162f('0x53')](_0x429c49[0x0]||null);};this['listenTo'](_0x2472db,'refresh',_0x5cc6fe),this['listenTo'](_0x2472db,_0x162f('0x2a'),(_0x1a1605,{isAnnotationTracked:_0x3699b8})=>{this['activeAnnotation']&&_0x3699b8(this[_0x162f('0x9')])&&(this[_0x162f('0x13')]([]),this[_0x162f('0x53')](null));}),this[_0x162f('0x2f')](_0x2472db,'uiUpdate',()=>{this[_0x162f('0x27')]();}),this[_0x162f('0x2f')](_0x33b963,_0x162f('0x2a'),_0x984f7f=>{_0x2472db[_0x162f('0x41')]()&&_0x984f7f[_0x162f('0x56')]();},{'priority':_0x162f('0x7')}),this[_0x162f('0x10')][_0x162f('0x2f')](document,_0x162f('0x40'),(_0x5cf3c4,_0x4874b0)=>{const _0x43b490=_0x4874b0[_0x162f('0x42')];_0x1569d7[_0x162f('0x19')]&&_0x1569d7[_0x162f('0x31')]['contains'](_0x43b490)||_0x3d705b['view']['element'][_0x162f('0x12')](_0x43b490)||this[_0x162f('0x9')]&&_0x2472db[_0x162f('0x41')]()&&(_0x5cc6fe(),_0x5cf3c4['preventClosingBalloon']=!0x0);},{'priority':_0x162f('0x7')}),this[_0x162f('0x29')]['add'](_0x2472db);}[_0x162f('0x3b')](_0x35c04f){_0x35c04f&&(this['stopListening'](_0x35c04f),this[_0x162f('0x29')][_0x162f('0x28')](_0x35c04f));}[_0x162f('0x13')](_0x474b33){for(const _0x1a6cf4 of this[_0x162f('0xd')])_0x474b33[_0x162f('0x51')](_0x1a6cf4)||this[_0x162f('0x4f')][_0x162f('0x4d')](_0x1a6cf4[_0x162f('0x8')]);this[_0x162f('0xd')]=_0x474b33;}[_0x162f('0x3f')](){const _0x37dd00=this[_0x162f('0x59')];this['annotations'][_0x162f('0x46')](),_0x37dd00[_0x162f('0x19')]&&this[_0x162f('0xa')]();}[_0x162f('0x2b')](_0x494803){if(this[_0x162f('0x4f')][_0x162f('0x54')](_0x494803[_0x162f('0x8')]))return;const _0x2568cf=this['balloonPanelView'][_0x162f('0x49')][_0x162f('0x48')];_0x2568cf!==_0x494803[_0x162f('0x8')]?(_0x2568cf&&this[_0x162f('0x4c')](_0x2568cf),this[_0x162f('0x1d')](_0x494803['view']),this['balloonPanelView'][_0x162f('0x49')][_0x162f('0x5')](),this['balloonPanelView'][_0x162f('0x49')]['add'](_0x494803[_0x162f('0x8')]),this[_0x162f('0xa')]()):this['_updateBalloonPosition']();}['_updateBalloonPosition'](){const _0x11c79d=this[_0x162f('0x59')][_0x162f('0x49')][_0x162f('0x48')],_0x42d90f=this['annotations'][_0x162f('0x5d')](_0x11c79d);if(!this[_0x162f('0x47')][_0x162f('0x54')](_0x42d90f))return;const _0xd373b7=this[_0x162f('0x47')][_0x162f('0x21')](_0x42d90f)[_0x162f('0x31')],_0x2af960=function(){const _0x50073c=_0x2912f0[_0x162f('0x16')];return[_0x50073c[_0x162f('0x26')],_0x50073c[_0x162f('0x2d')],_0x50073c[_0x162f('0x2c')],_0x50073c['northArrowSouth'],_0x50073c['southArrowNorthWest'],_0x50073c[_0x162f('0x5a')]];}();this['balloonPanelView']['pin']({'target':_0xd373b7,'positions':_0x2af960});}[_0x162f('0xc')](){const _0x2fe619=this[_0x162f('0x59')],_0x5ae7f8=_0x2fe619[_0x162f('0x49')][_0x162f('0x48')];_0x5ae7f8&&(this[_0x162f('0x4c')](_0x5ae7f8),_0x2fe619[_0x162f('0x44')](),_0x2fe619['content']['clear']());}[_0x162f('0x1d')](_0x1015d3){this['listenTo'](_0x1015d3,_0x162f('0x50'),()=>this[_0x162f('0xa')]()),this[_0x162f('0x2f')](_0x1015d3,'Esc',(_0x1ce694,_0x46b8c2)=>{this[_0x162f('0x4f')][_0x162f('0x18')](_0x1015d3),this[_0x162f('0xc')](),_0x46b8c2();});}['_detachListeners'](_0x45c9c6){this[_0x162f('0x17')](_0x45c9c6);}}