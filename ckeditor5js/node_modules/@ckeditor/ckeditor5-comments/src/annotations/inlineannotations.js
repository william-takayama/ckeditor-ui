/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2e82=['refresh','targetRect','delete','view','Esc','editableElement','stopListening','inlineannotations-not-allowed-with-context','InlineAnnotations','inlineannotations-attach-already-attached','_removeAnnotationFromBalloon','_addAnnotationToBalloon','change:isFocused','_selectedAnnotations','includes','register','addObserver','inlineannotations-detach-not-attached','set','get','getByView','hasActive','update','switchTo','isFocused','has','isAttached','showStack','change:visibleView','annotations','blur','_manuallyClosed','listenTo','context','attach','hasView','_balloon','clear','_setSelectedAnnotations','document','focus','getSelection','focusTracker','editor','init','visibleView','change:height','EditorAnnotations','add','editing','remove','target','setActiveAnnotation','inline','isActive','destroy','plugins','keystrokes','detach','_addedAnnotations','selection','bind','activeAnnotation','requires','updatePosition'];(function(_0x37ef3a,_0x2e82f8){const _0x579209=function(_0xd8fc4c){while(--_0xd8fc4c){_0x37ef3a['push'](_0x37ef3a['shift']());}};_0x579209(++_0x2e82f8);}(_0x2e82,0x14f));const _0x5792=function(_0x37ef3a,_0x2e82f8){_0x37ef3a=_0x37ef3a-0x0;let _0x579209=_0x2e82[_0x37ef3a];return _0x579209;};import{Plugin as _0x4f39d3}from'ckeditor5/src/core';import _0x43122b from'./annotationsuis';import _0x50c7c9 from'./editorannotations';import{ContextualBalloon as _0x1d4ae7}from'ckeditor5/src/ui';import{MouseObserver as _0x15145a}from'ckeditor5/src/engine';import{CKEditorError as _0x457991}from'ckeditor5/src/utils';import'./../../theme/annotation-inline.css';export default class a extends _0x4f39d3{static get[_0x5792('0x35')](){return[_0x50c7c9,_0x1d4ae7,_0x43122b];}static get['pluginName'](){return _0x5792('0x3f');}constructor(_0x48c18d){super(_0x48c18d),_0x48c18d[_0x5792('0x27')][_0x5792('0x3a')][_0x5792('0x6')](_0x15145a),this[_0x5792('0x10')]=!0x1,this['set'](_0x5792('0x34'),null),this['annotations']=null,this['_manuallyClosed']=new Set(),this['_balloon']=_0x48c18d['plugins'][_0x5792('0x9')](_0x1d4ae7),this['_addedAnnotations']=new Set(),this['_selectedAnnotations']=[];}[_0x5792('0x22')](){const _0x49b470=this['editor'][_0x5792('0x2e')][_0x5792('0x9')](_0x43122b);_0x49b470[_0x5792('0x17')]===this[_0x5792('0x21')]&&(_0x49b470[_0x5792('0x5')](_0x5792('0x2b'),this),this[_0x5792('0x21')][_0x5792('0x2f')][_0x5792('0x8')]('Esc',(_0x147dc7,_0x320682)=>{const _0x418249=this[_0x5792('0x1a')];if(this[_0x5792('0x10')]&&_0x418249['visibleView']){const _0x364cff=this['annotations']['getByView'](_0x418249[_0x5792('0x23')]);this[_0x5792('0x15')]['add'](_0x364cff),this[_0x5792('0x0')](_0x364cff),_0x320682();}}));}['afterInit'](){const _0x2c2a09=this['editor'][_0x5792('0x2e')]['get'](_0x43122b);_0x2c2a09[_0x5792('0x17')]===this[_0x5792('0x21')]&&(_0x2c2a09[_0x5792('0xb')]()||_0x2c2a09[_0x5792('0xd')]('inline'));}[_0x5792('0x2a')](_0x3ad36a){_0x3ad36a!==this[_0x5792('0x34')]&&(this[_0x5792('0x34')]&&(this[_0x5792('0x34')]['isActive']=!0x1),_0x3ad36a&&this[_0x5792('0x21')]['ui'][_0x5792('0x20')][_0x5792('0xe')]&&(this[_0x5792('0x1')](_0x3ad36a,!0x0),_0x3ad36a[_0x5792('0x2c')]=!0x0),_0x3ad36a||this['_setSelectedAnnotations']([]),this['activeAnnotation']=_0x3ad36a);}[_0x5792('0x18')](_0x2f034a){this[_0x5792('0x13')]=_0x2f034a;const _0x29c71d=this['editor'][_0x5792('0x2e')][_0x5792('0x9')](_0x43122b),_0x45cb42=this['_balloon'];if(this[_0x5792('0x10')])throw new _0x457991(_0x5792('0x40'),this);if(_0x29c71d[_0x5792('0x17')]!==this[_0x5792('0x21')])throw new _0x457991(_0x5792('0x3e'),this);const _0x1f66df=this[_0x5792('0x21')][_0x5792('0x2e')]['get'](_0x5792('0x25'));this[_0x5792('0x16')](_0x1f66df,_0x5792('0x37'),function(){const _0x55aae8=_0x1f66df['getOrderedSelectedAnnotations']({'activeAnnotation':this['activeAnnotation'],'annotations':this[_0x5792('0x13')]});this[_0x5792('0x1c')](_0x55aae8),this[_0x5792('0x2a')](_0x55aae8[0x0]||null);}[_0x5792('0x33')](this)),this[_0x5792('0x16')](_0x1f66df,_0x5792('0x14'),(_0x1146ed,{isAnnotationTracked:_0x5d1940})=>{this[_0x5792('0x34')]&&_0x5d1940(this[_0x5792('0x34')])&&(this[_0x5792('0x1c')]([]),this['setActiveAnnotation'](null));}),this[_0x5792('0x16')](this[_0x5792('0x21')]['ui'][_0x5792('0x20')],_0x5792('0x2'),(_0x594fc7,_0x4fae53,_0x36f1a9)=>{_0x36f1a9||this[_0x5792('0x2a')](null);}),this['listenTo'](_0x2f034a,_0x5792('0x28'),(_0x352298,_0x86ee90)=>{this[_0x5792('0x0')](_0x86ee90),_0x86ee90===this[_0x5792('0x34')]&&this[_0x5792('0x2a')](null);}),this[_0x5792('0x16')](_0x45cb42,_0x5792('0x12'),(_0x5134fc,_0x32e76e,_0x6a230b,_0x8463d5)=>{if(_0x8463d5&&this[_0x5792('0x3d')](_0x8463d5),!_0x6a230b||!_0x2f034a[_0x5792('0xa')](_0x6a230b))return;const _0x4e1401=_0x2f034a[_0x5792('0xa')](_0x6a230b);this['listenTo'](_0x6a230b,_0x5792('0x24'),()=>{_0x45cb42['updatePosition']();}),this['listenTo'](_0x6a230b,_0x5792('0x3b'),()=>{this[_0x5792('0x15')]['add'](_0x4e1401),this[_0x5792('0x0')](_0x4e1401),this[_0x5792('0x21')][_0x5792('0x27')][_0x5792('0x3a')][_0x5792('0x1e')]();}),this[_0x5792('0x34')]!==_0x4e1401&&this[_0x5792('0x2a')](_0x4e1401);}),this[_0x5792('0x16')](this[_0x5792('0x21')]['ui'],_0x5792('0xc'),()=>{_0x45cb42[_0x5792('0x23')]&&(_0x2f034a[_0x5792('0xa')](_0x45cb42[_0x5792('0x23')])&&_0x45cb42[_0x5792('0x36')]());}),this[_0x5792('0x16')](this[_0x5792('0x21')][_0x5792('0x27')]['view']['document'],'mousedown',()=>{this[_0x5792('0x15')][_0x5792('0x1b')]();}),this[_0x5792('0x21')][_0x5792('0x27')][_0x5792('0x3a')][_0x5792('0x1d')][_0x5792('0x32')][_0x5792('0x3c')]&&this[_0x5792('0x21')][_0x5792('0x27')][_0x5792('0x3a')][_0x5792('0x1e')](),this['isAttached']=!0x0;}[_0x5792('0x30')](){if(!this[_0x5792('0x10')])throw new _0x457991(_0x5792('0x7'),this);this[_0x5792('0x2a')](null);for(const _0x4c2e8f of this[_0x5792('0x31')])this[_0x5792('0x0')](_0x4c2e8f);this[_0x5792('0x3d')](),this[_0x5792('0x10')]=!0x1,this['annotations']=null;}[_0x5792('0x2d')](){this[_0x5792('0x10')]&&this[_0x5792('0x30')]();}[_0x5792('0x1c')](_0x1fe0f1){const _0x11d9eb=this[_0x5792('0x3')];for(const _0x3a7c72 of _0x11d9eb)_0x1fe0f1[_0x5792('0x4')](_0x3a7c72)||this[_0x5792('0x15')][_0x5792('0x39')](_0x3a7c72);for(const _0x519686 of this[_0x5792('0x13')])_0x1fe0f1[_0x5792('0x4')](_0x519686)||this['_removeAnnotationFromBalloon'](_0x519686);if(this[_0x5792('0x21')]['ui']['focusTracker'][_0x5792('0xe')])for(const _0x3d85df of _0x1fe0f1)this[_0x5792('0x1')](_0x3d85df);this[_0x5792('0x3')]=_0x1fe0f1;}['_addAnnotationToBalloon'](_0x1cbda2,_0x41c569){this[_0x5792('0x15')][_0x5792('0xf')](_0x1cbda2)||(this['_addedAnnotations']['has'](_0x1cbda2)||this[_0x5792('0x1a')][_0x5792('0x19')](_0x1cbda2[_0x5792('0x3a')])||(this[_0x5792('0x31')][_0x5792('0x26')](_0x1cbda2),this[_0x5792('0x1a')]['add']({'stackId':_0x1cbda2['view']['id'],'view':_0x1cbda2['view'],'position':{'target':()=>_0x1cbda2[_0x5792('0x29')]||_0x1cbda2[_0x5792('0x38')]||document[_0x5792('0x1f')]()['getRangeAt'](0x0)}})),_0x41c569&&this[_0x5792('0x1a')][_0x5792('0x11')](_0x1cbda2[_0x5792('0x3a')]['id']));}[_0x5792('0x0')](_0x6b5add){this['_addedAnnotations'][_0x5792('0xf')](_0x6b5add)&&this[_0x5792('0x1a')][_0x5792('0x19')](_0x6b5add[_0x5792('0x3a')])&&(this['_addedAnnotations'][_0x5792('0x39')](_0x6b5add),this[_0x5792('0x1a')][_0x5792('0x28')](_0x6b5add[_0x5792('0x3a')]));}}