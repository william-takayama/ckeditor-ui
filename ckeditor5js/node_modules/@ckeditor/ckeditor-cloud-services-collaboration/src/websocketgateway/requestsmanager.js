/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3350b6){return _0x3350b6&&_0x3350b6['__esModule']?_0x3350b6:{'default':_0x3350b6};};Object['defineProperty'](exports,'__esModule',{'value':!0x0});const ckeditorcloudserviceserror_1=__importDefault(require('../ckeditorcloudserviceserror'));class WebSocketRequest{constructor(_0x1320e6,_0x8b2ebb){this['_context']=_0x1320e6,this['_deferredPromise']=function(){let _0x38db22,_0x3c129b;const _0x345b2d=new Promise((_0x334fe6,_0x1f6606)=>{_0x38db22=_0x334fe6,_0x3c129b=_0x1f6606;});return{'resolve':_0x38db22,'reject':_0x3c129b,'promise':_0x345b2d};}(),this['timeout']=setTimeout(()=>this['error'](new ckeditorcloudserviceserror_1['default']('Request\x20timeout.',this['_context'])),_0x8b2ebb);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x154799){this['_deferredPromise']['resolve'](_0x154799);}['error'](_0x59f4bd){this['_deferredPromise']['reject'](_0x59f4bd);}}exports['default']=class{constructor(_0x43ba58){this['_context']=_0x43ba58,this['_requests']=new Set();}async['send'](_0x3b41bf,_0x31b3a1=0x2710){const _0x550d71=this['_createRequest'](_0x31b3a1);try{return _0x3b41bf(_0x550d71),await _0x550d71['promise'];}finally{this['_finishRequest'](_0x550d71);}}['errorAll'](_0x5b8401){for(const _0xa9b2b8 of this['_requests'])_0xa9b2b8['error'](_0x5b8401);}['_createRequest'](_0xc7ec85){const _0x280fc8=new WebSocketRequest(this['_context'],_0xc7ec85);return this['_requests']['add'](_0x280fc8),_0x280fc8;}['_finishRequest'](_0x10921a){this['_requests']['delete'](_0x10921a),clearTimeout(_0x10921a['timeout']);}};